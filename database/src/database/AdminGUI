package GutenSearch;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.Writer;
import java.util.ArrayList;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JTextField;

/*
 * AdminGUI
 * A class that creates the administrator GUI
 *
 * @author group 7
 */
public class AdminGUI
{

  ArrayList<JTextField> list = new ArrayList<JTextField>();
  Database db = new Database();
  JFrame adminFrame;
  String destination = "$HOME//Destop";

  /*
   * main
   */
  public static void main(String[] args)
  {
    AdminGUI gui = new AdminGUI();
    gui.adminGUI();
    
  }

  private void adminGUI()
  {
    final JFrame welcomeFrame = new JFrame("GutenSearch");
    welcomeFrame.setSize(800,800);
    welcomeFrame.setLayout(new BorderLayout());
    
    
    
    
    //LINK TO UserGUI SEARCH CODE
    JButton search = new JButton("Go to GutenSearch");
    search.addActionListener(new ActionListener()
    {
    	public void actionPerformed(ActionEvent e){
    		welcomeFrame.setVisible(false);
    		adminFrame = new JFrame("Admin");
    	    adminFrame.setSize(800, 800);
    		adminFrame.setVisible(true);
    	    adminFrame.setLayout(new GridLayout(6, 1));
  
    	}});
    
    
    
    //EDIT SOURCES, should be working as of now
    JButton edit = new JButton("Edit a Text");
    edit.addActionListener(new ActionListener()
    {
    	public void actionPerformed(ActionEvent e){
    		welcomeFrame.setVisible(false);
    		adminFrame = new JFrame("Admin");
    	    adminFrame.setSize(800, 800);
    		adminFrame.setVisible(true);
    	    adminFrame.setLayout(new GridLayout(6, 1));
    	    
    	    
    	    JPanel adminButtonPanel = new JPanel();
    	 
    	    JPanel oldTitleBoxPanel = new JPanel(new FlowLayout());
    	    oldTitleBoxPanel.add(new JLabel("Old Title*: "));
    	    JTextField ottf = new JTextField(20);
    	 
    	    oldTitleBoxPanel.add(ottf);

    	    JPanel oldAuthorBoxPanel = new JPanel(new FlowLayout());
    	    oldAuthorBoxPanel.add(new JLabel("Old Author*: "));
    	    JTextField oatf = new JTextField(20);

    	    oldAuthorBoxPanel.add(oatf);

    	    JPanel newTitleBoxPanel = new JPanel(new FlowLayout());
    	    newTitleBoxPanel.add(new JLabel("New Title: "));
    	    JTextField nttf = new JTextField(20);

    	    newTitleBoxPanel.add(nttf);

    	    JPanel newAuthorBoxPanel = new JPanel(new FlowLayout());
    	    newAuthorBoxPanel.add(new JLabel("New Author: "));
    	    JTextField natf = new JTextField(20);
    	    newAuthorBoxPanel.add(natf);

    	    JButton editSource = new JButton("Apply Edits");
    	    adminButtonPanel.add(editSource);
    	    editSource.addActionListener(new ActionListener()
    	    {
    	      public void actionPerformed(ActionEvent e)
    	      {
    	        db.editBook(list.get(0).getText(), list.get(1).getText(), list.get(2).getText(), list
    	            .get(3).getText());
    	        
    	        	//check title&author attributes and then have a Jdialog box
    	      }
    	    });

    	    list.add(ottf);
    	    list.add(nttf);
    	    list.add(oatf);
    	    list.add(natf);

    	    adminFrame.add(oldTitleBoxPanel);
    	    adminFrame.add(newTitleBoxPanel);
    	    adminFrame.add(oldAuthorBoxPanel);
    	    adminFrame.add(newAuthorBoxPanel);
    	    adminFrame.add(adminButtonPanel);

    	}});
    
    
    final JPanel adminButtonPanel = new JPanel();
    //Upload File
    JButton upload = new JButton("Upload a Text");
    upload.addActionListener(new ActionListener()
    {
    	public void actionPerformed(ActionEvent e)
    	{
    		welcomeFrame.setVisible(false);
    		adminFrame = new JFrame("Admin");
    	    adminFrame.setSize(800, 800);
    	    adminFrame.setLayout(new GridLayout(6, 1));
    	    adminFrame.add(adminButtonPanel);
    	    adminFrame.setVisible(true);
    	    		//2nd tier frame, choose file
    	    JButton uploadFile = new JButton("Choose File");
    	    adminButtonPanel.add(uploadFile);
    	    uploadFile.addActionListener(new ActionListener()
    	    {
    	      public void actionPerformed(ActionEvent e)
    	      {
    	        JFrame theFile = new JFrame();
    	        JFileChooser jfc = new JFileChooser();
    	        int retval = jfc.showOpenDialog(theFile);

    	        if (retval == JFileChooser.APPROVE_OPTION)
    	        {

    	          File selectedFile = jfc.getSelectedFile();
    	    
    	          System.out.println("File: " + selectedFile);
    	          try
    	          {
    	        	  String str = selectedFile.toString();
    	        	  String[] holder = str.split("/");
    	        	  System.out.println(destination + " " + holder[holder.length-1]);
    	        	  
    	        	 // selectedFile.renameTo(new File("C://cs//home//stu//fowlerne//Desktop//text//" + selectedFile.getName()));
    	        	  File dest = new File(destination + "/" + holder[holder.length-1]);
    	        	  dest.getParentFile().mkdirs();
    	        	  dest.createNewFile();
    	              //Writer output = new BufferedWriter(new FileWriter(dest));
    	           // db.addTxtFiles(selectedFile);
    	        	  InputStream input = null;
    	        	  
    	        	  	    OutputStream output = null;
    	        	  
    	        	  	    try {
    	        	  
    	        	  	        input = new FileInputStream(selectedFile);
    	        	  
    	        	  	        output = new FileOutputStream(dest);
    	        	  
    	        	  	        byte[] buf = new byte[1024];
    	        	  
    	        	  	        int bytesRead;
    	        	  
    	        	  	        while ((bytesRead = input.read(buf)) > 0) {
    	        	  
    	        	  	            output.write(buf, 0, bytesRead);
    	        	  
    	        	  	        }
    	        	  
    	        	  	    } finally {
    	        	  
    	        	  	        input.close();
    	        	  
    	        	  	        output.close();
    	        	  
    	        	  	    }
    	          }
    	          catch (IOException e1)
    	          {
    	            e1.printStackTrace();
    	          }
    	        }
    	        ;
    	       
    	      }
    	     
    	    });

    	}
    	
    	
    	
    	
    	
    });
    JPanel continuePanel = new JPanel(new FlowLayout());
    continuePanel.add(upload);
    continuePanel.add(edit);
    continuePanel.add(search);

    welcomeFrame.add(continuePanel, BorderLayout.SOUTH);
    		//logo should be put in with the package
    JLabel logo = new JLabel(new ImageIcon("//home//student//Desktop//gslogo.png"));
    JPanel logoPanel = new JPanel(new BorderLayout());
    logoPanel.setBackground(Color.WHITE);
    logoPanel.add(logo, BorderLayout.CENTER);
    
    JLabel guten = new JLabel("Welcome to GutenSearch");
    guten.setFont(new Font("Sans-Serif", Font.BOLD, 20));
    JPanel gutenPanel = new JPanel(new FlowLayout());
    gutenPanel.add(guten);
    
    logoPanel.add(gutenPanel, BorderLayout.NORTH);
   
    logoPanel.setBackground(Color.WHITE);

    welcomeFrame.add(logoPanel, BorderLayout.CENTER);
    welcomeFrame.setVisible(true);
	   
    //SET DIRECTORY
    
    //After choosing "Upload File, and set the directory for the "
    JButton setDirectoryButton = new JButton("Set Directory");
    adminButtonPanel.add(setDirectoryButton);
    setDirectoryButton.addActionListener(new ActionListener()
    {
    	public void actionPerformed(ActionEvent e){
    		JFrame chooser = new JFrame();
    		JFileChooser fileChooser = new JFileChooser();
    		fileChooser.setFileSelectionMode( JFileChooser.DIRECTORIES_ONLY);
    		
    		int retval = fileChooser.showOpenDialog(chooser);

            if (retval == JFileChooser.APPROVE_OPTION)
            {
            	destination = fileChooser.getSelectedFile().toString();
            	System.out.println(destination);
            	JOptionPane.showMessageDialog(chooser, "Directory Selected", "Confirmation", JOptionPane.PLAIN_MESSAGE);
            }
    	}});
//
//    JPanel oldTitleBoxPanel = new JPanel(new FlowLayout());
//    oldTitleBoxPanel.add(new JLabel("Old Title*: "));
//    JTextField ottf = new JTextField(20);
// 
//    oldTitleBoxPanel.add(ottf);
//
//    JPanel oldAuthorBoxPanel = new JPanel(new FlowLayout());
//    oldAuthorBoxPanel.add(new JLabel("Old Author*: "));
//    JTextField oatf = new JTextField(20);
//
//    oldAuthorBoxPanel.add(oatf);
//
//    JPanel newTitleBoxPanel = new JPanel(new FlowLayout());
//    newTitleBoxPanel.add(new JLabel("New Title: "));
//    JTextField nttf = new JTextField(20);
//
//    newTitleBoxPanel.add(nttf);
//
//    JPanel newAuthorBoxPanel = new JPanel(new FlowLayout());
//    newAuthorBoxPanel.add(new JLabel("New Author: "));
//    JTextField natf = new JTextField(20);
//    newAuthorBoxPanel.add(natf);
//
//    JButton editSource = new JButton("Edit Source");
//    adminButtonPanel.add(editSource);
//    editSource.addActionListener(new ActionListener()
//    {
//      public void actionPerformed(ActionEvent e)
//      {
//        db.editBook(list.get(0).getText(), list.get(1).getText(), list.get(2).getText(), list
//            .get(3).getText());
//      }
//    });
//
//    list.add(ottf);
//    list.add(nttf);
//    list.add(oatf);
//    list.add(natf);
//
//    adminFrame.add(adminButtonPanel);
//    adminFrame.add(oldTitleBoxPanel);
//    adminFrame.add(newTitleBoxPanel);
//    adminFrame.add(oldAuthorBoxPanel);
//    adminFrame.add(newAuthorBoxPanel);


    
  }
}
